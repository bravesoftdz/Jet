unit DBUtil;

interface

uses
  AppData, SysUtils;

procedure SetExpenseTypeIdentity;

implementation

procedure SetExpenseTypeIdentity;
var
  sqlStr: string;
  id: integer;
begin
  with dmApplication.fdqApp do
  begin
    try
      sqlStr := 'SELECT MAX(EXPENSE_ID) FROM T_EXPENSETYPE';
      SQL.Text := sqlStr;
      Open;

      // get the result
      id := Fields[0].Value;

      // set the identity
      Close;
      sqlStr := 'ALTER TABLE T_EXPENSETYPE ALTER EXPENSE_ID RESTART WITH ' + IntToStr(id);
      SQL.Text := sqlStr;
      ExecSQL;
    finally
      Close;
    end;
  end;
end;

end.
