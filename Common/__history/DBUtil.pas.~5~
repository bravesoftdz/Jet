unit DBUtil;

interface

uses
  AppData, SysUtils;

procedure SetClientIdentity;
procedure SetProjectIdentity;
procedure SetExpenseTypeIdentity;

implementation

procedure SetClientIdentity;
var
  sqlStr: string;
  id: integer;
begin
  with dmApplication.fdqApp do
  begin
    try
      sqlStr := 'SELECT MAX(CLIENT_ID) FROM CLIENT';
      SQL.Text := sqlStr;
      Open;

      // get the result
      id := Fields[0].Value;

      // set the identity
      Close;
      sqlStr := 'ALTER TABLE CLIENT ALTER CLIENT_ID RESTART WITH ' + IntToStr(id);
      SQL.Text := sqlStr;
      ExecSQL;
    finally
      Close;
    end;
  end;
end;

procedure SetProjectIdentity;
var
  sqlStr: string;
  id: integer;
begin
  with dmApplication.fdqApp do
  begin
    try
      sqlStr := 'SELECT MAX(PROJECT_ID) FROM PROJECT';
      SQL.Text := sqlStr;
      Open;

      // get the result
      id := Fields[0].Value;

      // set the identity
      Close;
      sqlStr := 'ALTER TABLE PROJECT ALTER PROJECT_ID RESTART WITH ' + IntToStr(id);
      SQL.Text := sqlStr;
      ExecSQL;
    finally
      Close;
    end;
  end;
end;


procedure SetExpenseTypeIdentity;
var
  sqlStr: string;
  id: integer;
begin
  with dmApplication.fdqApp do
  begin
    try
      sqlStr := 'SELECT MAX(EXPENSE_ID) FROM T_EXPENSETYPE';
      SQL.Text := sqlStr;
      Open;

      // get the result
      id := Fields[0].Value;

      // set the identity
      Close;
      sqlStr := 'ALTER TABLE T_EXPENSETYPE ALTER EXPENSE_ID RESTART WITH ' + IntToStr(id);
      SQL.Text := sqlStr;
      ExecSQL;
    finally
      Close;
    end;
  end;
end;

end.
